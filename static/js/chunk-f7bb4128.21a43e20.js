(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f7bb4128","chunk-a9dfa19c","chunk-e1eafa70"],{"30a9":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editDia"},[i("el-dialog",{attrs:{title:t.title,width:"90vw",top:"3vh",visible:t.dialogVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("picture-library",{ref:"pic",on:{getData:t.setCover}}),i("el-card",{staticClass:"anoCard"},[i("div",{staticClass:"box"},[i("div",{staticClass:"cover",on:{click:function(e){return t.$refs.pic.open(!1)}}},[t.docData.cover?[i("BaseElImage",{attrs:{custom_style:{width:"100%",height:"100%"},custom_src:t.docData.cover,fit:"cover"}})]:[i("div",{staticClass:"coverTips"},[i("i",{staticClass:"el-icon-picture"}),t._v("\n            点击选择封面\n          ")])]],2),i("div",{staticClass:"doc-form"},[i("el-form",{attrs:{"label-position":"right","label-width":"0",model:t.docData}},[i("el-form-item",{attrs:{label:""}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.docData.title,expression:"docData.title"}],staticClass:"my-input title",attrs:{type:"text",placeholder:"请输入标题"},domProps:{value:t.docData.title},on:{input:function(e){e.target.composing||t.$set(t.docData,"title",e.target.value)}}})]),i("el-form-item",{attrs:{label:""}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.docData.author,expression:"docData.author"}],staticClass:"my-input author",attrs:{type:"text",placeholder:"请输入作者"},domProps:{value:t.docData.author},on:{input:function(e){e.target.composing||t.$set(t.docData,"author",e.target.value)}}})]),i("el-form-item",{attrs:{label:""}},[i("el-input",{staticClass:"my-input summary",attrs:{type:"textarea",rows:4,placeholder:"请输入摘要"},model:{value:t.docData.summary,callback:function(e){t.$set(t.docData,"summary",e)},expression:"docData.summary"}})],1),i("el-form-item",{attrs:{label:""}},[i("u-e",{ref:"quill",on:{senHtml:t.getHtml,UECover:t.UECover}})],1),i("el-form-item",{attrs:{label:""}},[i("div",{staticClass:"submitWrap"},[i("div",{staticStyle:{"margin-right":"20px"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.docData.group_id,callback:function(e){t.$set(t.docData,"group_id",e)},expression:"docData.group_id"}},[i("el-option",{attrs:{label:"未分组",value:"0"}}),t._l(t.groupList,(function(t){return i("el-option",{key:t.group_id,attrs:{label:t.group_name,value:t.group_id}})}))],2)],1),this.doc_id?i("el-button",{attrs:{icon:"el-icon-s-promotion",type:"primary"},on:{click:t.check_docData}},[t._v("编辑")]):i("el-button",{attrs:{icon:"el-icon-s-promotion",type:"primary"},on:{click:t.check_docData}},[t._v("发布")])],1)])],1)],1)])])],1)],1)},s=[],o=i("cebc"),c=i("cf2d"),n=i("0bba"),r=i("e475"),l=(i("3022"),{name:"media.edit",components:{UE:c["a"],PictureLibrary:n["a"]},data:function(){return{dialogVisible:!1,videoSelectModal:!1,groupList:[],doc_id:"",docData:{author:"",title:"",summary:"",cover:"",content:"",group_id:"0"}}},computed:{title:function(){return this.doc_id?"编辑图文消息":"新增图文消息"}},created:function(){this.getResGroups()},filters:{},methods:{open:function(t){t?(this.doc_id=t,this.getDoc()):this.doc_id="",this.dialogVisible=!0},handleClose:function(){this.dialogVisible=!1,this.docData={author:"",title:"",summary:"",cover:"",content:"",group_id:"0"},console.log("关闭弹窗")},UECover:function(t){this.docData.cover||(this.docData.cover=t)},getResGroups:function(){var t=this;Object(r["e"])({group_type:4}).then((function(e){0==e.code&&(t.groupList=e.data)}))},setCover:function(t){console.log(t),this.docData.cover=t.src_file},getHtml:function(t){this.docData.content=t},check_docData:function(){""!==this.docData.title?""!==this.docData.author?""!==this.docData.content?""!==this.docData.summary?""!==this.docData.cover?this.doc_id?this.modDoc():this.addDoc():this.$message({message:"请选择封面",type:"warning"}):this.$message({message:"请输入摘要",type:"warning"}):this.$message({message:"请输入内容",type:"warning"}):this.$message({message:"请输入作者",type:"warning"}):this.$message({message:"请输入标题",type:"warning"})},addDoc:function(){var t=this;Object(r["a"])(Object(o["a"])({},this.docData)).then((function(e){0==e.code&&t.$message({message:"发布成功",type:"success",duration:1e3}),t.dialogVisible=!1,t.$parent.getDocList()}),(function(t){}))},modDoc:function(){var t=this;Object(r["f"])(Object(o["a"])({},this.docData)).then((function(e){t.$message({message:"编辑成功",type:"success",duration:1e3}),t.dialogVisible=!1,t.$parent.getDocList()}),(function(t){}))},getDoc:function(){var t=this;Object(r["c"])({doc_id:this.doc_id}).then((function(e){0==e.code&&(t.docData=e.data,t.$refs.quill.setContent(e.data.content))}),(function(t){console.log(t)}))}}}),d=l,u=(i("976b"),i("2877")),p=Object(u["a"])(d,a,s,!1,null,"f8902c5a",null);e["default"]=p.exports},"3ae7":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"doc"},[i("div",{staticClass:"doc-header"},[i("div",{staticClass:"groupTitle"},[i("div",{staticClass:"title"},[t._v("分组列表")]),i("el-popover",{attrs:{placement:"top",width:"300",trigger:"click"},model:{value:t.disabled,callback:function(e){t.disabled=e},expression:"disabled"}},[i("div",{staticClass:"addGroup"},[i("div",{staticClass:"addGroupTitle"},[t._v("分组标题")]),i("el-input",{staticStyle:{margin:"10px 0"},attrs:{placeholder:"请输入组名"},model:{value:t.group_name,callback:function(e){t.group_name=e},expression:"group_name"}}),i("div",{staticClass:"add-btn"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.disabled=!1}}},[t._v("取消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addResGroup}},[t._v("添加")])],1)],1),i("el-button",{attrs:{slot:"reference",plain:"",type:"primary",size:"mini",icon:"el-icon-plus"},slot:"reference"},[t._v("新增分组")])],1)],1),i("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.selectDArr.length,expression:"selectDArr.length"}],staticClass:"img-select-list"},[i("div",{staticClass:"len"},[t._v("\n          共选择\n          "),i("el-link",{staticClass:"link-a",attrs:{icon:"el-icon-picture",type:"primary"}},[t._v(t._s(t.selectDArr.length))]),t._v("个图文消息\n        ")],1),i("div",{staticClass:"link-wrap"},[i("el-link",{staticClass:"link-a close",attrs:{icon:"el-icon-close",underline:!1,type:"primary"},on:{click:t.closeDSelect}},[t._v("全部取消")]),i("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:t.delDSelect}},[i("el-link",{staticClass:"link-a del",attrs:{slot:"reference",icon:"el-icon-delete",underline:!1,type:"danger"},slot:"reference"},[t._v("删除")])],1)],1)])]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:t.toAdd}},[t._v("新增图文消息")])],1),i("div",{staticClass:"mainContent"},[i("div",{staticClass:"tabWrap"},[i("el-tabs",{attrs:{"tab-position":"left"},on:{"tab-click":t.change},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[i("el-tab-pane",{attrs:{name:"0"}},[i("span",{staticClass:"label",attrs:{slot:"label"},on:{click:t.removeRe},slot:"label"},[t._v("未分组")])]),t._l(t.groupList,(function(e){return i("el-tab-pane",{key:e.group_id,attrs:{name:e.group_id}},[i("div",{staticClass:"tabItem",attrs:{slot:"label"},on:{click:function(i){return t.mouseOver(e.group_id)}},slot:"label"},[i("span",{staticClass:"label"},[t._v(t._s(e.group_name))]),i("el-popover",{ref:"labPop",refInFor:!0,attrs:{placement:"right",width:"190",trigger:"click","v-model":t.activeId==e.group_id}},[i("div",{staticClass:"setBtnClass"},[i("el-popover",{ref:"setPop",refInFor:!0,attrs:{placement:"right",width:"300",trigger:"click","v-model":t.activeId==e.group_id},on:{hide:t.hidePopover}},[i("div",{staticClass:"modGroup"},[i("div",{staticClass:"addGroupTitle"},[t._v("分组标题")]),i("el-input",{staticStyle:{margin:"10px 0"},attrs:{placeholder:"请输入新组名"},model:{value:t.group_name,callback:function(e){t.group_name=e},expression:"group_name"}}),i("div",{staticClass:"mod-btn"},[i("el-button",{attrs:{type:"primary"},on:{click:function(i){return t.modResGroup(e.group_id)}}},[t._v("修改")])],1)],1),i("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-edit"},on:{click:function(i){return t.editTab(e.group_name)}},slot:"reference"},[t._v("编辑")])],1),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(i){return t.delResGroup(e.group_id)}}},[t._v("删除")])],1),i("i",{directives:[{name:"show",rawName:"v-show",value:t.activeId==e.group_id,expression:"activeId == item.group_id"}],staticClass:"el-icon-setting settingIcon",attrs:{slot:"reference"},nativeOn:{click:function(t){t.stopPropagation()}},slot:"reference"})])],1)])}))],2)],1),i("div",{staticClass:"anoCard"},t._l(t.docData.list,(function(e,a){return i("div",{key:a,staticClass:"box-card",class:{"border-gray":t.checkDSelect(e.doc_id)},on:{click:function(i){return t.select(e)}}},[i("div",{staticClass:"pic"},[i("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.base_img+e.cover,fit:"cover"}})],1),i("div",{staticClass:"name"},[i("i",{staticClass:"el-icon-download preview",on:{click:function(i){return i.stopPropagation(),t.toPre(e.doc_url)}}}),i("div",{staticClass:"file_name"},[t._v(t._s(e.title))])]),i("div",{staticClass:"controlBtn"},[i("i",{staticClass:"el-icon-document-copy iconStyel",on:{click:function(i){return i.stopPropagation(),t.copy(e.doc_url)}}}),i("i",{staticClass:"el-icon-edit iconStyel",on:{click:function(i){return i.stopPropagation(),t.edit(e)}}}),i("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(i){return t.del(e)}}},[i("i",{staticClass:"el-icon-delete iconStyel",attrs:{slot:"reference"},on:{click:function(t){t.stopPropagation()}},slot:"reference"})])],1),i("div",{staticClass:"checked",class:{"opacity-toggle":t.checkDSelect(e.doc_id)}},[i("i",{staticClass:"el-icon-check icon"})])])})),0)]),i("pagination",{attrs:{data:t.docData},on:{change:t.getDocList}}),i("edit-dia",{ref:"editDia"})],1)},s=[],o=(i("20d6"),i("cebc")),c=i("bd86"),n=i("4632"),r=i("30a9"),l=i("e475"),d=i("d1eb"),u=i("2f62"),p={name:"media.doc",components:{pagination:n["a"],editDia:r["default"]},data:function(){return Object(c["a"])({selectDArr:[],docData:{list:[]},groupList:[],group_name:"",active:"0",disabled:!1,activeId:"",setDisabled:!1},"group_name","")},computed:Object(o["a"])({},Object(u["b"])(["base_img"])),created:function(){this.getDocList(),this.getResGroups()},activated:function(){this.$route.params.refresh&&(this.getDocList(),this.getResGroups(),this.$route.params.refresh=!1)},filters:{},methods:{closeDSelect:function(){this.selectDArr.splice(0,this.selectDArr.length)},delDSelect:function(){var t=this,e=[];this.selectDArr.map((function(t){e.push(t.doc_id)}));var i=JSON.stringify(e);Object(l["b"])({docs:i}).then((function(e){0==e.code&&(t.$message({type:"success",message:"删除成功!"}),t.getDocList(1),t.selectDArr.splice(0,t.selectDArr.length))}))},checkDSelect:function(t){return this.selectDArr.some((function(e){return e.doc_id==t}))},select:function(t){var e=this.selectDArr.findIndex((function(e){return e.doc_id==t.doc_id}));-1==e?this.selectDArr.push(t):this.selectDArr.splice(e,1)},hidePopover:function(){console.log("关闭"),this.group_name=""},copy:function(t){var e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("Copy"),document.body.removeChild(e),this.$message({message:"复制成功",type:"success"})},toPre:function(t){window.open(t,"_blank")},modResGroup:function(t){var e=this;console.log(this.group_name,t,"提交新组名"),Object(d["v"])({group_name:this.group_name,group_id:t}).then((function(i){e.$message({message:"修改成功",type:"success"}),e.setDisabled=!1,e.group_name="",e.$refs.setPop.map((function(t,i){t.doClose(),e.$refs.labPop[i].doClose()})),e.getResGroups(t),e.activeId=t,e.active=t}))},editTab:function(t){console.log("点击了编辑功能"),this.group_name=t},mouseOver:function(t){console.log(t),this.activeId=t},removeRe:function(){this.activeId=""},toAdd:function(){this.$refs.editDia.open()},change:function(t){this.getDocList()},getResGroups:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0";Object(d["o"])({group_type:4}).then((function(i){0==i.code&&(t.groupList=i.data,t.active=e+"")}))},delResGroup:function(t){var e=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["i"])({group_id:t}).then((function(t){0==t.code&&(e.$message({message:"删除成功",type:"success"}),e.getResGroups(),e.active="0")}))}))},addResGroup:function(){var t=this,e=this.group_name,i=this.active;Object(d["d"])({group_type:4,group_name:e,group_id:i}).then((function(e){0==e.code&&(t.$message({message:"添加成功",type:"success"}),t.disabled=!1,t.group_name="",t.getResGroups(e.data.group_id),t.activeId=e.data.group_id)}))},getDocList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=this.active;this.docData={list:[]},Object(l["d"])({page:e,group_id:i}).then((function(e){0==e.code&&e.data&&(t.docData=e.data)}))},edit:function(t){console.log(t.doc_id),this.$refs.editDia.open(t.doc_id)},del:function(t){var e=this,i=[];i.push(t.doc_id);var a=JSON.stringify(i);Object(l["b"])({docs:a}).then((function(t){0==t.code&&(e.$message({message:"删除成功",duration:1e3,type:"success"}),e.getDocList())}))}}},m=p,g=(i("a5ac"),i("9936"),i("2877")),v=Object(g["a"])(m,a,s,!1,null,"761ef2e4",null);e["default"]=v.exports},"586b":function(t,e,i){},"5f86":function(t,e,i){"use strict";i.r(e);var a=i("3ae7");e["default"]=a["default"]},"976b":function(t,e,i){"use strict";var a=i("ce51"),s=i.n(a);s.a},9936:function(t,e,i){"use strict";var a=i("586b"),s=i.n(a);s.a},a5ac:function(t,e,i){"use strict";var a=i("bfab"),s=i.n(a);s.a},bfab:function(t,e,i){},ce51:function(t,e,i){}}]);