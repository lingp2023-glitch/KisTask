(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74bec958"],{"617f":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"UpLoadForm"},[0==e.type?[i("upload",{attrs:{group_id:e.group_id,groupList:e.groupList},on:{"after-upload":e.refreshPage}})]:[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-upload2"},on:{click:e.upLoadDia}},[e._v("新增"+e._s(e.title))]),i("input",{ref:"fileUpload",staticStyle:{display:"none"},attrs:{type:"file",multiple:""},on:{change:e.multipleUploadFile}}),i("el-dialog",{attrs:{title:"上传"+e.title,visible:e.dialog,"before-close":e.handleClose,"close-on-click-modal":!1,"append-to-body":!0},on:{"update:visible":function(t){e.dialog=t}}},[i("el-form",{ref:"formData",attrs:{model:e.formData,"status-icon":"","label-width":"auto",rules:e.rules}},[i("el-form-item",{attrs:{label:"分组",prop:"group_id"}},[i("el-select",{staticStyle:{width:"30%"},attrs:{placeholder:"请选择分组"},model:{value:e.formData.group_id,callback:function(t){e.$set(e.formData,"group_id",t)},expression:"formData.group_id"}},[i("el-option",{attrs:{label:"未分组",value:"0"}}),e._l(e.groupList,function(e){return i("el-option",{key:e.group_id,attrs:{label:e.group_name,value:e.group_id}})})],2)],1),i("el-form-item",{attrs:{label:"本地素材",prop:"files"}},[2==e.group_type?i("el-upload",{ref:"Imageupload",attrs:{action:"","http-request":e.uploadImage,"on-remove":e.handleRemove,multiple:"","list-type":"picture-card",limit:8,"on-exceed":e.handleExceed,accept:"audio/x-m4a, audio/mp3, audio/mpeg"},scopedSlots:e._u([{key:"file",fn:function(t){var a=t.file;return i("div",{},[i("div",{staticClass:"audioClass"},[i("i",{staticClass:"el-icon-microphone icon"}),i("div",{staticClass:"audioTitle"},[e._v("\n                  "+e._s(a.name)+"\n                ")])]),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(a,e.fileList,!0)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,2336809216)},[i("i",{staticClass:"el-icon-plus"})]):e._e(),3==e.group_type?i("el-upload",{ref:"Imageupload",attrs:{action:"","http-request":e.uploadImage,"on-remove":e.handleRemove,multiple:"","list-type":"picture-card",limit:8,"on-exceed":e.handleExceed,accept:"video/mp4"},scopedSlots:e._u([{key:"file",fn:function(t){var a=t.file;return i("div",{},[i("div",{staticClass:"videoClass"},[i("el-image",{staticStyle:{width:"146px",height:"146px"},attrs:{src:e.base_img+e.videoCoverMap[a.uid],fit:"cover"}})],1),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(a,e.fileList,!0)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,404594771)},[i("i",{staticClass:"el-icon-plus"})]):e._e(),4==e.group_type?i("el-upload",{ref:"Imageupload",attrs:{action:"","http-request":e.uploadImage,"on-remove":e.handleRemove,multiple:"",limit:8,"on-exceed":e.handleExceed}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1):e._e()],1)],1),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"新建"+e.title,top:"4vh",visible:e.dialogVisible,width:"1000px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.ruleForm,border:"","header-cell-style":{background:"#eef1f6",color:"#606266"}}},[i("el-table-column",{attrs:{prop:"cover",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[3==e.group_type?i("BaseElImage",{attrs:{custom_style:{width:"50px",height:"50px"},custom_src:t.row.cover,fit:"cover"}}):e._e(),i("p",[e._v(e._s(t.row.file_name))])],1)]}}])}),2==e.group_type||3==e.group_type?i("el-table-column",{attrs:{prop:"url",label:"路径"}}):e._e(),2==e.group_type||3==e.group_type?i("el-table-column",{attrs:{width:"100",prop:"duration",label:"时长"}}):e._e(),i("el-table-column",{attrs:{width:"200",prop:"file_size",label:"文件大小"}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("确 定")])],1)],1)]],2)},s=[],l=(i("96cf"),i("3b8d")),r=(i("5df3"),i("1c4c"),i("7f7f"),i("6b54"),i("cebc")),n=i("d1eb"),o=i("ae4a"),c=i("2f62"),u=(n["d"],n["x"],n["a"],n["b"],n["e"],n["k"],{components:{upload:o["b"],UploadAVF:o["a"]},inject:["getPageData","pageData","refreshPage"],props:{groupList:{type:Array,required:!0,default:function(){return[]}},group_type:{type:String,required:!0},group_id:{type:String,required:!0}},data:function(){return{dialogVisible:!1,file_name:"",loading:!1,ruleForm:{},fileList:[],tips:"",dialog:!1,formData:{group_id:"0",files:[]},rules:{group_id:[{required:!0,message:"请选择分组",trigger:"blur"}],files:[{required:!0,message:"请选择素材",trigger:"blur"}]},filesData:[],videoCoverMap:{}}},filters:{},computed:Object(r["a"])({},Object(c["b"])(["base_img"]),{mtd:function(){switch(this.group_type){case"1":return"图片";case"2":return"音频";case"3":return"视频";case"4":return"文件";default:return""}},title:function(){switch(this.group_type){case"1":return"图片";case"2":return"音频";case"3":return"视频";case"4":return"文件";default:return""}},remarks:function(){switch(this.group_type){case"2":return"格式支持m4a, aac, mp3, wav,文件大小不超过30M，语音时长不超过30分钟";case"3":return"格式支持mp4, 文件大小不超过30M，视频时长不超过30分钟";case"4":return"支持doc，xls，ppt，txt，gif，rar，zip等格式的文件，注意文件大小不得超过30M";default:return""}},type:function(){switch(this.group_type){case"1":return 0;default:return this.group_type-1}}}),deactivated:function(){},methods:{submit:function(){var e=this;console.log("点击了提交"),this.$refs["formData"].validate(function(t){t&&(console.log(t),console.log(e.formData),e.addImage())})},addImage:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=this,t=this.formData.group_id,i=JSON.stringify(this.formData.imgs);addImage({group_id:t,imgs:i}).then(function(t){0==t.code&&(e.$message({message:"图片上传成功！",type:"success"}),e.$emit("after-upload"),e.handleClose())})}),upLoadDia:function(){this.dialog=!0},handleClose:function(){this.$refs["formData"].clearValidate(),this.$refs["Imageupload"].clearFiles(),this.dialog=!1,this.formData={group_id:"0",files:[]},this.filesData=[],this.videoCoverMap={}},uploadImage:function(e){console.log(e,"上传上传"),this.upload(e.file)},handleRemove:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=-1;this.filesData.map(function(t,i){t.uid==e.uid&&(a=i)}),-1!=a&&(this.filesData.splice(a,1),this.formData.files.splice(a,1),i&&this.$refs["Imageupload"].handleRemove(e))},handleExceed:function(e,t){this.$message({type:"error",message:"当前限制选择 8 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件")})},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},multipleUploadFile:function(){var e=this,t=Array.from(this.$refs.fileUpload.files),i=[];t.map(function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(a,s){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:i.push(e.upload(a,s));case 1:case"end":return t.stop()}},t)}));return function(e,i){return t.apply(this,arguments)}}()),this.tips=this.$loading({lock:!0,text:"上传中(0/".concat(this.$refs.fileUpload.files.length,")"),spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.tips.successCount=0,this.tips.count=0,Promise.allSettled(i).then(function(t){e.ruleForm=t.filter(function(e){return"fulfilled"==e.status}).map(function(e){return e.value}),e.ruleForm.length>0&&(e.dialogVisible=!0),e.$refs.fileUpload.files.value=null,e.tips.close(),e.tips=null})},upload:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var i,a,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.tips=this.$loading({lock:!0,text:"上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),i=this.type,a={},e.next=5,Object(n["x"])({file:t,type:i}).then(function(e){if(console.log(e),0==e.code){var t=e.data,i=t.file_name,s=t.file_size,l=t.url;a.file_name=i,a.file_size=s,a.file=l,e.data.file_type&&(a.file_type=e.data.file_type)}else console.log("error, uploadFile")}).finally(function(){if(3==s.group_type){var e=a.file;Object(n["q"])({file_url:e}).then(function(e){console.log("getVideoCover",e),0==e.code?(s.$set(s.videoCoverMap,t.uid,e.data.cover),a=Object.assign(a,e.data)):console.log("error, getVideoCover")}).finally(function(){})}else if(2==s.group_type){var i=a.url;Object(n["k"])({audio_file:i}).then(function(e){console.log("getAudioDuration",e),0==e.code?a=Object.assign(a,e.data):console.log("error, getAudioDuration")}).finally(function(){})}else 4==s.group_type&&console.log(a)});case 5:this.tips.close(),this.formData.files.push(a),this.filesData.push({data:a,uid:t.uid}),console.log(this.videoCoverMap),console.log(this.filesData);case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),add:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=this.group_type,e.next="2"===e.t0?3:"3"===e.t0?6:"4"===e.t0?9:12;break;case 3:return e.next=5,this.addAudio();case 5:return e.abrupt("break",13);case 6:return e.next=8,this.addVideo();case 8:return e.abrupt("break",13);case 9:return e.next=11,this.addFile();case 11:return e.abrupt("break",13);case 12:return e.abrupt("break",13);case 13:this.refreshPage();case 14:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),addAudio:function(){var e=this,t=[];this.filesData.map(function(e,i){t.push(e.data)}),t=JSON.stringify(t),console.log(t,this.filesData);var i=this.group_id;Object(n["a"])({files:t,group_id:i}).then(function(t){0==t.code&&(e.$message({message:"素材上传成功！",type:"success"}),e.getPageData(1),e.handleClose())},function(e){})},addVideo:function(){var e=this,t=[];this.filesData.map(function(e,i){t.push(e.data)}),t=JSON.stringify(t),console.log(t);var i=this.group_id;Object(n["e"])({files:t,group_id:i}).then(function(t){0==t.code&&(e.$message({message:"素材上传成功！",type:"success"}),e.getPageData(1),e.handleClose())},function(e){})},addFile:function(){var e=this,t=[];this.filesData.map(function(e,i){t.push(e.data)}),t=JSON.stringify(t),console.log(t);var i=this.group_id;Object(n["b"])({files:t,group_id:i}).then(function(t){0==t.code&&(e.getPageData(1),e.handleClose())},function(e){})},close:function(){this.ruleForm=[],this.file_name=""}}}),d=u,p=(i("ebad"),i("2877")),f=Object(p["a"])(d,a,s,!1,null,"e550aa2a",null);t["default"]=f.exports},"72ea":function(e,t,i){},c2b0:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"static-group"},[i("div",{staticClass:"groupTitle"},[i("div",{staticClass:"title"},[e._v("分组列表")]),i("el-popover",{attrs:{placement:"top",width:"300",trigger:"click"},model:{value:e.disabled,callback:function(t){e.disabled=t},expression:"disabled"}},[i("div",{staticClass:"addGroup"},[i("div",{staticClass:"addGroupTitle"},[e._v("分组标题")]),i("el-input",{staticStyle:{margin:"10px 0"},attrs:{placeholder:"请输入组名"},model:{value:e.group_name,callback:function(t){e.group_name=t},expression:"group_name"}}),i("div",{staticClass:"add-btn"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.disabled=!1}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addResGroup}},[e._v("添加")])],1)],1),i("el-button",{attrs:{slot:"reference",plain:"",type:"primary",size:"mini",icon:"el-icon-plus"},slot:"reference"},[e._v("新增分组")])],1)],1),i("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectArr.length,expression:"selectArr.length"}],staticClass:"img-select-list"},[i("div",{staticClass:"len"},[e._v("\n        共选择\n        "),i("el-link",{staticClass:"link-a",attrs:{icon:"el-icon-picture",type:"primary"}},[e._v(e._s(e.selectArr.length))]),e._v("张图片\n      ")],1),i("div",{staticClass:"link-wrap"},[i("el-link",{staticClass:"link-a close",attrs:{icon:"el-icon-close",underline:!1,type:"primary"},on:{click:e.closeSelect}},[e._v("全部取消")]),i("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:e.delSelect}},[i("el-link",{staticClass:"link-a del",attrs:{slot:"reference",icon:"el-icon-delete",underline:!1,type:"danger"},slot:"reference"},[e._v("删除")])],1)],1)])]),i("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectVArr.length,expression:"selectVArr.length"}],staticClass:"img-select-list"},[i("div",{staticClass:"len"},[e._v("\n        共选择\n        "),i("el-link",{staticClass:"link-a",attrs:{icon:"el-icon-picture",type:"primary"}},[e._v(e._s(e.selectVArr.length))]),e._v("个视频\n      ")],1),i("div",{staticClass:"link-wrap"},[i("el-link",{staticClass:"link-a close",attrs:{icon:"el-icon-close",underline:!1,type:"primary"},on:{click:e.closeVSelect}},[e._v("全部取消")]),i("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:e.delVSelect}},[i("el-link",{staticClass:"link-a del",attrs:{slot:"reference",icon:"el-icon-delete",underline:!1,type:"danger"},slot:"reference"},[e._v("删除")])],1)],1)])]),i("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectAArr.length,expression:"selectAArr.length"}],staticClass:"img-select-list"},[i("div",{staticClass:"len"},[e._v("\n        共选择\n        "),i("el-link",{staticClass:"link-a",attrs:{icon:"el-icon-picture",type:"primary"}},[e._v(e._s(e.selectAArr.length))]),e._v("个语音\n      ")],1),i("div",{staticClass:"link-wrap"},[i("el-link",{staticClass:"link-a close",attrs:{icon:"el-icon-close",underline:!1,type:"primary"},on:{click:e.closeASelect}},[e._v("全部取消")]),i("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:e.delASelect}},[i("el-link",{staticClass:"link-a del",attrs:{slot:"reference",icon:"el-icon-delete",underline:!1,type:"danger"},slot:"reference"},[e._v("删除")])],1)],1)])]),i("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectFArr.length,expression:"selectFArr.length"}],staticClass:"img-select-list"},[i("div",{staticClass:"len"},[e._v("\n        共选择\n        "),i("el-link",{staticClass:"link-a",attrs:{icon:"el-icon-picture",type:"primary"}},[e._v(e._s(e.selectFArr.length))]),e._v("个文件\n      ")],1),i("div",{staticClass:"link-wrap"},[i("el-link",{staticClass:"link-a close",attrs:{icon:"el-icon-close",underline:!1,type:"primary"},on:{click:e.closeFSelect}},[e._v("全部取消")]),i("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:e.delFSelect}},[i("el-link",{staticClass:"link-a del",attrs:{slot:"reference",icon:"el-icon-delete",underline:!1,type:"danger"},slot:"reference"},[e._v("删除")])],1)],1)])]),i("div",{staticClass:"right"},[i("div",{staticClass:"upload-btn"},[i("up-load-form",{attrs:{group_type:e.group_type,groupList:e.groupList,group_id:e.group_id}})],1)])],1)},s=[],l=i("d1eb"),r=i("617f"),n={components:{UpLoadForm:r["default"]},inject:["getResGroups","selectArr","selectVArr","selectAArr","selectFArr","getPageData"],props:["group_type","group_id","groupList"],data:function(){return{group_name:"",disabled:!1}},methods:{closeSelect:function(){this.selectArr.splice(0,this.selectArr.length)},closeVSelect:function(){this.selectVArr.splice(0,this.selectVArr.length)},closeASelect:function(){this.selectAArr.splice(0,this.selectAArr.length)},closeFSelect:function(){this.selectFArr.splice(0,this.selectFArr.length)},delSelect:function(){var e=this,t=[];this.selectArr.map(function(e){t.push(e.image_id)});var i=JSON.stringify(t);Object(l["h"])({imgs:i}).then(function(t){0==t.code&&(e.$message({type:"success",message:"删除成功!"}),e.getPageData(1),e.selectArr.splice(0,e.selectArr.length))})},delVSelect:function(){var e=this;console.log(this.selectVArr,"删除视频");var t=[];this.selectVArr.map(function(e){t.push(e.video_id)});var i=JSON.stringify(t);Object(l["j"])({videos:i}).then(function(t){0==t.code&&(e.$message({message:"删除成功",duration:1e3,type:"success"}),e.getPageData(1),e.selectVArr.splice(0,e.selectVArr.length))})},delASelect:function(){var e=this;console.log(this.selectAArr,"删除音频");var t=[];this.selectAArr.map(function(e){t.push(e.audio_id)});var i=JSON.stringify(t);Object(l["f"])({audios:i}).then(function(t){0==t.code&&(e.$message({message:"删除成功",duration:1e3,type:"success"}),e.getPageData(1),e.selectAArr.splice(0,e.selectAArr.length))})},delFSelect:function(){var e=this;console.log(this.selectFArr,"删除文件");var t=[];this.selectFArr.map(function(e){t.push(e.file_id)});var i=JSON.stringify(t);Object(l["g"])({files:i}).then(function(t){0==t.code&&(e.$message({message:"删除成功",duration:1e3,type:"success"}),e.getPageData(1),e.selectFArr.splice(0,e.selectFArr.length))})},addResGroup:function(){var e=this,t=this.group_type,i=this.group_name;""!=i?Object(l["d"])({group_type:t,group_name:i}).then(function(t){0==t.code&&(e.$message({type:"success",message:"添加成功!"}),e.disabled=!1,e.group_name="",e.getResGroups(t.data.group_id),e.$bus.$emit("finishAddView",t.data.group_id))},function(e){console.log(e)}):this.$message({message:"请输入组名",type:"warning"})}}},o=n,c=(i("d188"),i("2877")),u=Object(c["a"])(o,a,s,!1,null,"17dddac5",null);t["default"]=u.exports},d188:function(e,t,i){"use strict";var a=i("72ea"),s=i.n(a);s.a},d550:function(e,t,i){},ebad:function(e,t,i){"use strict";var a=i("d550"),s=i.n(a);s.a}}]);