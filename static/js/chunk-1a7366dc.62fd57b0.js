(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a7366dc"],{1262:function(t,e,o){},"24d2":function(t,e,o){"use strict";o.d(e,"g",(function(){return n})),o.d(e,"f",(function(){return a})),o.d(e,"i",(function(){return r})),o.d(e,"h",(function(){return l})),o.d(e,"d",(function(){return c})),o.d(e,"e",(function(){return u})),o.d(e,"j",(function(){return d})),o.d(e,"k",(function(){return f})),o.d(e,"a",(function(){return p})),o.d(e,"c",(function(){return m})),o.d(e,"l",(function(){return h})),o.d(e,"b",(function(){return b}));var i=o("365c"),s={addProject:"add",editProject:"mod",getProjectList:"list",delProject:"del",flowStautsMod:"flowStautsMod",flowStatus:"flowStatus",flowActions:"flowActions",flowActionMod:"flowActionMod",flowInfo:"flowInfo",flowMod:"flowMod",flowAdd:"flowAdd",flowDel:"flowDel"};function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.flowDel,t,"api/project")}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.flowAdd,t,"api/project")}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.flowMod,t,"api/project")}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.flowInfo,t,"api/project")}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.flowActionMod,t,"api/project")}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.flowActions,t,"api/project")}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.flowStatus,t,"api/project")}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.flowStautsMod,t,"api/project")}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.addProject,t,"api/project")}function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.editProject,t,"api/project")}function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.getProjectList,t,"api/project")}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i["a"].post(s.delProject,t,"api/project")}},2959:function(t,e,o){"use strict";o.r(e);var i,s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"className"},[o("el-card",[o("div",{attrs:{slot:"header"},slot:"header"},[t._v("\n      编辑工作流\n    ")]),o("div",{staticClass:"box"},[o("el-tabs",{on:{"tab-click":t.changeTab},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[o("el-tab-pane",{attrs:{label:"基本信息",name:"baseInfo"}},[o("div",{staticClass:"formClass"},[o("el-form",{ref:"baseInfoForm",staticClass:"demo-ruleForm",attrs:{model:t.baseInfoForm,"status-icon":"","label-width":"auto",rules:t.rules}},[o("el-form-item",{attrs:{label:"工作流名称",prop:"name"}},[o("el-input",{staticStyle:{width:"20vw"},attrs:{type:"text",autocomplete:"off"},model:{value:t.baseInfoForm.name,callback:function(e){t.$set(t.baseInfoForm,"name",e)},expression:"baseInfoForm.name"}})],1),o("el-form-item",{attrs:{label:"工作流说明",prop:"intro"}},[o("el-input",{staticStyle:{width:"20vw"},attrs:{type:"textarea",autocomplete:"off"},model:{value:t.baseInfoForm.intro,callback:function(e){t.$set(t.baseInfoForm,"intro",e)},expression:"baseInfoForm.intro"}})],1)],1),o("div",{staticClass:"chitrolBtn"},[o("el-button",{attrs:{type:"primary"},on:{click:t.submitBaseInfo}},[t._v("保存&下一步")]),o("el-button",{on:{click:t.back}},[t._v("取消")])],1)],1)]),o("el-tab-pane",{attrs:{label:"状态定义",name:"statusSet"}},[o("div",{staticClass:"searchDiv"},[o("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:t.addStatus}},[t._v("添加状态")])],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.statusList,border:""}},[o("el-table-column",{attrs:{prop:"name",label:"状态名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",[t._v(t._s(e.row.name))])]}}])}),o("el-table-column",{attrs:{prop:"intro",label:"状态说明"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(e.row.intro?e.row.intro:"-")+"\n              ")]}}])}),o("el-table-column",{attrs:{prop:"name",label:"起始状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("input",{attrs:{type:"radio",name:"begin",value:"1"},domProps:{checked:1==e.row.is_begin},on:{click:function(o){return t.handleBegin(e.$index)}}})]}}])}),o("el-table-column",{attrs:{prop:"name",label:"结束状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("input",{attrs:{type:"checkbox",name:"end",value:"1"},domProps:{checked:1==e.row.is_end},on:{click:function(o){return t.handleEnd(e.$index)}}})]}}])}),o("el-table-column",{attrs:{prop:"create_time",label:"操作",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return t.editSatus(e.row,e.$index)}}},[t._v("编辑")]),o("el-popconfirm",{attrs:{title:"你确定要删除吗？",confirmButtonType:"danger"},on:{confirm:function(o){return t.delStatus(e.$index)}}},[o("el-button",{staticStyle:{"margin-left":"8px"},attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),o("div",{staticClass:"chitrolBtn"},[o("el-button",{attrs:{type:"primary"},on:{click:t.submitStatusInfo}},[t._v("保存&下一步")]),o("el-button",{on:{click:t.back}},[t._v("取消")])],1)],1),o("el-tab-pane",{attrs:{label:"流转设置",name:"flowSet"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.flowList,border:""}},[o("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                从【"+t._s(e.row.src_status)+"】中可流转到\n              ")]}}])}),t._l(t.flowList,(function(e,i){return o("el-table-column",{key:i,attrs:{label:e.src_status},scopedSlots:t._u([{key:"default",fn:function(i){return[o("input",{attrs:{type:"checkbox"},domProps:{checked:i.row.dst_status.includes(e.src_status)},on:{click:function(o){return t.handleFlow(i.$index,e.src_status)}}})]}}],null,!0)})}))],2),o("div",{staticClass:"chitrolBtn"},[o("el-button",{attrs:{type:"primary"},on:{click:t.sumbitFlowInfo}},[t._v("保存")])],1)],1),o("el-tab-pane",{attrs:{label:"流转设置",name:"flow"}},[o("div",{ref:"container",staticStyle:{height:"75vh"}}),o("div",{staticClass:"chitrolBtn"},[o("el-button",{attrs:{type:"primary"}},[t._v("保存")])],1)])],1)],1)]),o("el-dialog",{attrs:{width:"30vw",title:"mod"==t.formType?"修改状态":"新增状态",visible:t.statusDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.statusDialog=e},closed:t.closedDialog}},[o("el-form",{ref:"statusForm",attrs:{"label-width":"auto",model:t.statusForm,rules:t.statusRules}},[o("el-form-item",{attrs:{label:"状态名称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入状态名称"},model:{value:t.statusForm.name,callback:function(e){t.$set(t.statusForm,"name",e)},expression:"statusForm.name"}})],1),o("el-form-item",{attrs:{label:"状态说明",prop:"intro"}},[o("el-input",{attrs:{type:"textarea",placeholder:"请输入状态说明"},model:{value:t.statusForm.intro,callback:function(e){t.$set(t.statusForm,"intro",e)},expression:"statusForm.intro"}})],1)],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.statusDialog=!1}}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.submitStatus}},[t._v("确 定")])],1)],1)],1)},n=[],a=o("bd86"),r=(o("7f7f"),o("75fc")),l=o("24d2"),c=(o("5728"),i={data:function(){return{project_id:"",activeName:"baseInfo",baseInfoForm:{name:"",intro:""},rules:{name:[{required:!0,message:"请输入工作流名称",trigger:"blur"}]},statusList:[],selectedOption:"",formType:"add",statusDialog:!1,statusForm:{name:"",intro:"",is_begin:0,is_end:0},statusRules:{name:[{required:!0,message:"请输入工作流名称",trigger:"blur"}]},activeStatusIndex:null,flowList:[],graph:null,nodes:[],edges:[],selectedNodeId:null,editModalVisible:!1,importModalVisible:!1,zoom:1,editingNodeId:null,importDataJson:"",editingNodeData:{label:"",content:"",color:"#1890ff"},textData:'{ "cells": [ { "shape": "edge", "attrs": { "line": { "stroke": "#A2B1C3", "targetMarker": { "name": "block", "width": 12, "height": 8 } } }, "id": "11a736b1-6456-4b54-a99f-ec5633e026f0", "labels": [ { "position": 0.5, "attrs": { "text": { "text": "" } } } ], "zIndex": 0, "source": { "cell": "rect-node-1764900801592", "port": "right-port" }, "target": { "cell": "circle-node-1764900806320", "port": "top-port" } }, { "position": { "x": 180, "y": 330 }, "size": { "width": 140, "height": 60 }, "attrs": { "body": { "stroke": "#1890ff" }, "label": { "text": "矩形节点1" }, "content": { "text": "测试" } }, "visible": true, "shape": "custom-rect", "ports": { "groups": { "top": { "position": "top", "attrs": { "circle": { "r": 4, "magnet": true, "stroke": "#5F95FF", "strokeWidth": 1, "fill": "#fff", "style": { "visibility": "hidden" } } } }, "right": { "position": "right", "attrs": { "circle": { "r": 4, "magnet": true, "stroke": "#5F95FF", "strokeWidth": 1, "fill": "#fff", "style": { "visibility": "hidden" } } } }, "bottom": { "position": "bottom", "attrs": { "circle": { "r": 4, "magnet": true, "stroke": "#5F95FF", "strokeWidth": 1, "fill": "#fff", "style": { "visibility": "hidden" } } } }, "left": { "position": "left", "attrs": { "circle": { "r": 4, "magnet": true, "stroke": "#5F95FF", "strokeWidth": 1, "fill": "#fff", "style": { "visibility": "hidden" } } } } }, "items": [ { "group": "top", "id": "top-port" }, { "group": "right", "id": "right-port" }, { "group": "bottom", "id": "bottom-port" }, { "group": "left", "id": "left-port" } ] }, "id": "rect-node-1764900801592", "data": { "label": "矩形节点1", "content": "测试", "color": "#1890ff" }, "zIndex": 1 }, { "position": { "x": 550, "y": 250 }, "size": { "width": 80, "height": 80 }, "attrs": { "body": { "stroke": "#52c41a", "fill": "rgba(82, 196, 26, 0.1)" }, "label": { "text": "圆形节点2" }, "content": { "text": "测试" } }, "visible": true, "shape": "custom-circle", "ports": { "groups": { "top": { "position": "top", "attrs": { "circle": { "r": 4, "magnet": true, "stroke": "#5F95FF", "strokeWidth": 1, "fill": "#fff", "style": { "visibility": "hidden" } } } }, "right": { "position": "right", "attrs": { "circle": { "r": 4, "magnet": true, "stroke": "#5F95FF", "strokeWidth": 1, "fill": "#fff", "style": { "visibility": "hidden" } } } }, "bottom": { "position": "bottom", "attrs": { "circle": { "r": 4, "magnet": true, "stroke": "#5F95FF", "strokeWidth": 1, "fill": "#fff", "style": { "visibility": "hidden" } } } }, "left": { "position": "left", "attrs": { "circle": { "r": 4, "magnet": true, "stroke": "#5F95FF", "strokeWidth": 1, "fill": "#fff", "style": { "visibility": "hidden" } } } } }, "items": [ { "group": "top", "id": "top-port" }, { "group": "right", "id": "right-port" }, { "group": "bottom", "id": "bottom-port" }, { "group": "left", "id": "left-port" } ] }, "id": "circle-node-1764900806320", "data": { "label": "圆形节点2", "content": "测试", "color": "#52c41a" }, "zIndex": 2 } ] }'}},computed:{},components:{},filters:{},created:function(){this.project_id=this.$route.params.project_id,this.flowStatus()},onLoad:function(t){},onShow:function(){},mounted:function(){}},Object(a["a"])(i,"computed",{}),Object(a["a"])(i,"methods",{sumbitFlowInfo:function(){var t=this;Object(l["d"])({project_id:this.project_id,flow_id:"",actions:JSON.stringify(this.flowList)}).then((function(e){0==e.code&&t.$message({message:"保存流程成功",type:"success"})}))},flowActions:function(){var t=this;Object(l["e"])({project_id:this.project_id,flow_id:""}).then((function(e){console.log(e),t.flowList=e.data}))},handleFlow:function(t,e){var o=this.flowList[t].dst_status.indexOf(e);this.flowList[t].dst_status=-1!==o?[].concat(Object(r["a"])(this.flowList[t].dst_status.slice(0,o)),Object(r["a"])(this.flowList[t].dst_status.slice(o+1))):[].concat(Object(r["a"])(this.flowList[t].dst_status),[e])},handleBegin:function(t){this.statusList.map((function(e,o){e.is_begin=t==o?1:0}))},handleEnd:function(t){this.statusList[t].is_end=1==this.statusList[t].is_end?0:1,console.log(this.statusList)},flowStatus:function(){var t=this;Object(l["j"])({project_id:this.project_id,flow_id:""}).then((function(e){0==e.code&&(t.statusList=e.data?e.data:[])}))},submitStatusInfo:function(){var t=this;0!=this.statusList.length?Object(l["k"])({project_id:this.project_id,flow_id:"",status:JSON.stringify(this.statusList)}).then((function(e){0==e.code&&(t.$message({message:"保存状态成功",type:"success"}),t.activeName="flowSet",t.flowActions())})):this.$message({message:"请添加状态",type:"warning"})},closedDialog:function(){this.$refs["statusForm"].clearValidate(),this.statusForm={name:"",intro:"",is_begin:0,is_end:0},this.formType="add"},submitStatus:function(){var t=this;this.$refs["statusForm"].validate((function(e){e&&("mod"==t.formType?(t.$set(t.statusList,t.activeStatusIndex,t.statusForm),t.statusDialog=!1):(t.statusList.push(t.statusForm),t.statusDialog=!1))}))},addStatus:function(){this.formType="add",this.statusDialog=!0},delStatus:function(t){this.statusList.splice(t,1)},editSatus:function(t,e){this.activeStatusIndex=e,this.statusForm.name=t.name,this.statusForm.intro=t.intro,this.statusForm.is_begin=t.is_begin,this.statusForm.is_end=t.is_end,this.formType="mod",this.statusDialog=!0},submitBaseInfo:function(){this.activeName="statusSet"},back:function(){this.$router.go(-1)},changeTab:function(t){"flowSet"==t.name&&this.flowActions()}}),i),u=c,d=(o("b47a"),o("2877")),f=Object(d["a"])(u,s,n,!1,null,"72318340",null);e["default"]=f.exports},b47a:function(t,e,o){"use strict";var i=o("1262"),s=o.n(i);s.a}}]);