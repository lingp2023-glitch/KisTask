(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-90e434fa"],{"29d1":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"addOrModStaff"},[o("el-dialog",{attrs:{title:1==e.dialogType?"编辑员工":"新增员工",visible:e.dialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialog=t},closed:e.closedDialog}},[o("el-form",{ref:"form",attrs:{"label-width":"110px",model:e.form,rules:e.rules}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[o("el-input",{attrs:{type:"tel",placeholder:"请输入联系电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),o("el-form-item",{attrs:{label:"角色",prop:"role"}},[o("el-radio",{attrs:{label:1},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[e._v("店长")]),o("el-radio",{attrs:{label:2},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[e._v("店员")])],1),o("el-form-item",{attrs:{label:"门店"}},[o("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),o("div",{staticStyle:{margin:"15px 0"}}),o("el-checkbox-group",{on:{change:e.handleCheckedShopsChange},model:{value:e.checkedShops,callback:function(t){e.checkedShops=t},expression:"checkedShops"}},e._l(e.shops,(function(t,n){return o("el-checkbox",{key:n,attrs:{label:t.shop_id}},[e._v(e._s(t.shop_name))])})),1)],1)],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialog=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},a=[],s=(o("7f7f"),o("e692")),i=o("b4ea"),l={data:function(){return{dialogType:0,dialog:!1,staff_id:null,form:{name:"",phone:"",role:1},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}]},checkAll:!1,checkedShops:[],shops:[],isIndeterminate:!0,shopData:[]}},components:{},filters:{},onLoad:function(e){},onShow:function(){},mounted:function(){},computed:{},methods:{handleCheckAllChange:function(e){var t=this;console.log(e),this.checkedShops=[],e&&this.shops.map((function(e,o){t.checkedShops.push(e.shop_id)})),this.isIndeterminate=!1},handleCheckedShopsChange:function(e){console.log(e);var t=e.length;this.checkAll=t===this.shops.length,this.isIndeterminate=t>0&&t<this.shops.length},getShopList:function(){var e=this;Object(s["j"])().then((function(t){0==t.code&&(console.log(t.data),e.shops=t.data.list)}))},open:function(e,t){console.log(t),this.getShopList(),"mod"==e&&(this.dialogType=1,this.staff_id=t.staff_id,this.form.name=t.name,this.form.phone=t.phone,this.form.role=t.role,this.checkedShops=t.shops?JSON.parse(t.shops):[],console.log(this.form)),this.dialog=!0},closedDialog:function(){this.$refs["form"].clearValidate(),this.form={name:"",phone:"",role:1},this.checkedShops=[],this.staff_id=null},submit:function(){var e=this;console.log("点击了提交"),0!=this.checkedShops.length?this.$refs["form"].validate((function(t){if(t){console.log("验证通过");var o={};o.name=e.form.name,o.phone=e.form.phone,o.role=e.form.role,o.shops=JSON.stringify(e.checkedShops),1==e.dialogType?(o.staff_id=e.staff_id,e.modStaff(o)):e.addStaff(o)}else console.log("验证失败")})):this.$message({message:"请选择门店",type:"warning"})},modStaff:function(e){var t=this;Object(i["f"])(e).then((function(e){0==e.code&&t.$message({message:"修改员工成功",type:"success"}),t.dialog=!1,t.$parent.refresh()}))},addStaff:function(e){var t=this;Object(i["a"])(e).then((function(e){0==e.code&&t.$message({message:"新增员工成功",type:"success"}),t.dialog=!1,t.$parent.refresh()}))}}},r=l,f=o("2877"),c=Object(f["a"])(r,n,a,!1,null,"eead73de",null);t["default"]=c.exports},b4ea:function(e,t,o){"use strict";o.d(t,"a",(function(){return s})),o.d(t,"c",(function(){return i})),o.d(t,"b",(function(){return l})),o.d(t,"g",(function(){return r})),o.d(t,"f",(function(){return f})),o.d(t,"d",(function(){return c}));var n=o("365c"),a={addStaff:"add",getStaffList:"list",delStaff:"del",unbindStaff:"unbind",modStaff:"mod",getWxBind:"wxbind",staffActive:"active"};function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].post(a.addStaff,e,"api/staff")}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].post(a.getStaffList,e,"api/staff")}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].post(a.delStaff,e,"api/staff")}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].post(a.unbindStaff,e,"api/staff")}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].post(a.modStaff,e,"api/staff")}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].post(a.getWxBind,e,"api/staff")}}}]);