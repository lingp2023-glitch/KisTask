(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ac63e04"],{"2aec":function(e,t,i){},"467d":function(e,t,i){"use strict";var o=i("2aec"),n=i.n(o);n.a},ec6a:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"schRuleDia"},[i("el-dialog",{attrs:{title:"配置档期规则",visible:e.show,width:"70%",top:"10px","close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},closed:e.handleClose}},[i("div",{staticClass:"diaHeader",attrs:{slot:"title"},slot:"title"},[i("div",[e._v("\n        配置档期规则 （"+e._s(e.shop_name)+"）\n      ")])]),i("div",[i("el-row",[i("el-col",{attrs:{span:8}},[i("el-form",{ref:"form",staticClass:"form",attrs:{rules:e.rules,model:e.rule_info,"label-width":"auto"}},[i("el-form-item",{attrs:{label:"营业开始时间",prop:"btime"}},[i("el-time-select",{attrs:{placeholder:"开始时间","picker-options":{start:"00:00",step:"00:30",end:"24:00"}},model:{value:e.rule_info.btime,callback:function(t){e.$set(e.rule_info,"btime",t)},expression:"rule_info.btime"}})],1),i("el-form-item",{attrs:{label:"营业结束时间",prop:"etime"}},[i("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:"00:00",step:"00:30",end:"24:00",minTime:e.rule_info.btime}},model:{value:e.rule_info.etime,callback:function(t){e.$set(e.rule_info,"etime",t)},expression:"rule_info.etime"}})],1),i("el-form-item",{attrs:{label:"档期时长",prop:"unit_time"}},[i("el-input-number",{staticStyle:{"margin-right":"10px"},attrs:{min:0},model:{value:e.rule_info.unit_time,callback:function(t){e.$set(e.rule_info,"unit_time",t)},expression:"rule_info.unit_time"}}),e._v("分钟\n            ")],1),i("el-form-item",{attrs:{label:"档期间隔",prop:"space_time"}},[i("el-input-number",{staticStyle:{"margin-right":"10px"},attrs:{min:0},model:{value:e.rule_info.space_time,callback:function(t){e.$set(e.rule_info,"space_time",t)},expression:"rule_info.space_time"}}),e._v("分钟\n            ")],1),i("el-form-item",{attrs:{label:"默认工位",prop:"work_num"}},[i("el-input-number",{attrs:{min:0},model:{value:e.rule_info.work_num,callback:function(t){e.$set(e.rule_info,"work_num",t)},expression:"rule_info.work_num"}})],1)],1),i("el-alert",{attrs:{title:"规则说明",type:"info"}},[e._v("\n            在 "),i("span",{staticStyle:{color:"#e53f31"}},[e._v(e._s(e.rule_info.btime))]),e._v(" - "),i("span",{staticStyle:{color:"#e53f31"}},[e._v(e._s(e.rule_info.etime))]),e._v(" 时间段内，每间隔 "),i("span",{staticStyle:{color:"#e53f31"}},[e._v(e._s(e.rule_info.space_time))]),e._v(" 分钟生成一个档期，档期时长为 "),i("span",{staticStyle:{color:"#e53f31"}},[e._v(e._s(e.rule_info.unit_time))]),e._v(" 分钟，默认每个档期拥有 "),i("span",{staticStyle:{color:"#e53f31"}},[e._v(e._s(e.rule_info.work_num))]),e._v(" 个工位(可修改 )，状态为开启(可修改 )\n          ")]),i("div",{staticClass:"controlBtn"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitRule}},[e._v("确认规则")])],1)],1),i("el-col",{attrs:{span:16}},[i("div",{staticClass:"scrollBox"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.schedule_work,border:""}},[i("el-table-column",{attrs:{prop:"work_time",label:"显示名称"}}),i("el-table-column",{attrs:{label:"时间跨度"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  "+e._s(t.row.work_btime)+" - "+e._s(t.row.work_etime)+"\n                ")]}}])}),i("el-table-column",{attrs:{prop:"work_num",label:"工位"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input-number",{attrs:{size:"mini",min:0},on:{change:function(t){e.cantRun=!1}},model:{value:t.row.work_num,callback:function(i){e.$set(t.row,"work_num",i)},expression:"scope.row.work_num"}})]}}])}),i("el-table-column",{attrs:{prop:"is_work",label:"是否开启",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){e.cantRun=!1}},model:{value:t.row.is_work,callback:function(i){e.$set(t.row,"is_work",i)},expression:"scope.row.is_work"}})]}}])})],1)],1)])],1),i("span",{staticClass:"dialog-footer"},[i("el-button",{attrs:{type:e.cantRun?"info":"primary",disabled:e.cantRun},on:{click:e.scheduleRuleRun}},[e._v("生成档期")])],1)],1)])],1)},n=[],s=i("e692"),l={data:function(){return{show:!1,shop_id:"",shop_name:"",rule_info:{btime:"",etime:"",unit_time:30,space_time:"",work_num:1},rules:{btime:[{required:!0,message:"请选择营业开始时间",trigger:"blur"}],etime:[{required:!0,message:"请选择营业结束时间",trigger:"blur"}],unit_time:[{required:!0,message:"请输入档期时长",trigger:"blur"}],space_time:[{required:!0,message:"请输入档期间隔",trigger:"blur"}],work_num:[{required:!0,message:"请输入默认工时",trigger:"blur"}]},schedule_work:[],cantRun:!0}},components:{},filters:{},onLoad:function(e){},onShow:function(){},mounted:function(){},computed:{},methods:{scheduleRuleRun:function(){var e=this,t=this.$loading();Object(s["l"])({shop_id:this.shop_id,rule_info:JSON.stringify(this.rule_info),work_info:JSON.stringify(this.schedule_work)}).then(function(t){0==t.code?(e.$message({message:"修改成功",type:"success"}),e.$parent.getScheduleList&&e.$parent.getScheduleList(!0)):e.$message({message:t.msg?t.msg:"修改失败",type:"error"})}).finally(function(){t.close()})},handleClose:function(){console.log("123123"),this.$refs["form"].clearValidate(),this.show=!1,this.cantRun=!0,this.rule_info={btime:"",etime:"",unit_time:30,space_time:"",work_num:1}},submitRule:function(){var e=this;this.$refs.form.validate(function(t){if(t){var i=JSON.stringify(e.rule_info),o=e.$loading();Object(s["m"])({shop_id:e.shop_id,rule_info:i}).then(function(t){e.$message({message:"保存成功",type:"success"}),e.schedule_work=t.data,e.cantRun=!1}).finally(function(){o.close()})}})},open:function(e,t){this.show=!0,this.shop_id=e,this.shop_name=t,this.getSchRule()},getSchRule:function(){var e=this;Object(s["g"])({shop_id:this.shop_id}).then(function(t){console.log(t),0==t.code&&(t.data.schedule_rule?e.rule_info=JSON.parse(t.data.schedule_rule):e.rule_info={btime:"",etime:"",unit_time:30,space_time:"",work_num:1},t.data.schedule_work?e.schedule_work=JSON.parse(t.data.schedule_work):e.schedule_work=[])})}}},r=l,a=(i("467d"),i("2877")),u=Object(a["a"])(r,o,n,!1,null,"4a4dc579",null);t["default"]=u.exports}}]);