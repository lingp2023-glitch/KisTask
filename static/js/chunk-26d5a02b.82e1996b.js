(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26d5a02b","chunk-612451b0","chunk-0060c4cb"],{"0067":function(e,t,o){"use strict";var s=o("e013"),i=o.n(s);i.a},"63cb":function(e,t,o){"use strict";o.r(t);var s=o("da09");t["default"]=s["default"]},"87f8":function(e,t,o){},a7c6:function(e,t,o){"use strict";var s=o("87f8"),i=o.n(s);i.a},c226:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"addOrModShop"},[o("el-dialog",{attrs:{top:"10px",title:0==e.formType?"新增机构":"编辑机构",visible:e.dialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialog=t},closed:e.closedDialog}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"label-width":"110px",model:e.form,rules:e.rules,"element-loading-text":"获取位置中，请稍后~"}},[o("el-form-item",{attrs:{label:"机构名称",prop:"shop_name"}},[o("el-input",{model:{value:e.form.shop_name,callback:function(t){e.$set(e.form,"shop_name",t)},expression:"form.shop_name"}})],1),o("el-form-item",{attrs:{label:"地址",prop:"address"}},[o("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}}),o("div",{staticClass:"btn_group"},[o("el-button",{on:{click:function(t){return e.getLocation(!1)}}},[e._v("自动定位")]),o("el-button",{on:{click:e.openMap}},[e._v("手动定位")])],1)],1),o("el-form-item",{attrs:{label:"经度",prop:"lng"}},[o("el-input",{model:{value:e.form.lng,callback:function(t){e.$set(e.form,"lng",t)},expression:"form.lng"}})],1),o("el-form-item",{attrs:{label:"纬度",prop:"lat"}},[o("el-input",{model:{value:e.form.lat,callback:function(t){e.$set(e.form,"lat",t)},expression:"form.lat"}})],1)],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialog=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{width:"50%",title:"高德地图",visible:e.inner,"append-to-body":""},on:{"update:visible":function(t){e.inner=t}}},[o("div",[o("el-amap",{ref:"map",staticClass:"amapClass",attrs:{center:e.center,"map-style":"amap://styles/62009be025f187dd3eafe327d2e55b8e",zoom:12,"extra-options":{vectorMapForeign:"style_zh_cn"}},on:{click:e.mapClick}},e._l(e.markers,(function(e,t){return o("el-amap-marker",{key:t,attrs:{position:e.position,visible:e.visible,vid:t}})})),1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.selectPosition}},[e._v("确 定")])],1)]),o("div",{attrs:{id:"container"}})],1)},i=[],a=o("63cb"),n=o("e692"),r=(o("3022"),{data:function(){return{typeName:null,typeData:{1:"线下零售",2:"美食餐饮",3:"婚庆摄影",4:"美容美发",5:"休闲娱乐",6:"教育医疗",7:"交通运输",8:"其他"},shopType:[{id:1,name:"线下零售"},{id:2,name:"美食餐饮"},{id:3,name:"婚庆摄影"},{id:4,name:"美容美发"},{id:5,name:"休闲娱乐"},{id:6,name:"教育医疗"},{id:7,name:"交通运输"},{id:8,name:"其他"}],loading:!1,inner:!1,markers:[{position:[0,0],visible:!0,draggable:!1,template:""}],map:null,loadingMap:!1,center:[],dialog:!1,formType:0,shop_id:null,shopCover:null,form:{shop_name:"",address:"",lng:"",lat:""},rules:{shop_name:[{required:!0,message:"请输入商户名称",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],lng:[{required:!0,message:"请输入经度",trigger:"blur"}],lat:[{required:!0,message:"请输入纬度",trigger:"blur"}]}}},components:{formCover:a["default"]},activated:function(){},watch:{},created:function(){},mounted:function(){},methods:{selectChange:function(e){this.form.shop_type=e,this.$refs["form"].validateField("shop_type")},finishChoose:function(e){this.form.shop_logo=e,this.$refs["form"].validateField("shop_logo")},getLocation:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(console.log(e),this.map=new AMap.Map("container",{}),e){if(this.form.lng&&this.form.lat)this.markers[0].position=[this.form.lng,this.form.lat],this.center=[this.form.lng,this.form.lat];else{var t=this.map.getCenter();this.form.lng=t.lng,this.form.lat=t.lat,this.markers[0].position=[t.lng,t.lat],this.center=[t.lng,t.lat],this.codeToAddress()}this.inner=!0}else""==this.form.address?this.$refs["form"].validateField("address"):this.addressToCode()},addressToCode:function(){var e=this;this.formatAddress(this.form.address),console.log(this.form.address),this.map.plugin("AMap.Geocoder",(function(){var t=new AMap.Geocoder({});t.getLocation(e.form.address,(function(t,o){"complete"===t&&"OK"===o.info&&(console.log(o),e.form.lng=o.geocodes[0].location.lng,e.form.lat=o.geocodes[0].location.lat,e.$refs["form"].validateField("lng"),e.$refs["form"].validateField("lat"))}))}))},codeToAddress:function(){var e=this;this.map.plugin("AMap.Geocoder",(function(){var t=new AMap.Geocoder({});t.getAddress([e.form.lng,e.form.lat],(function(t,o){"complete"===t&&"OK"===o.info&&(console.log(o),e.form.address=o.regeocode.formattedAddress,e.$refs["form"].validateField("address"))}))}))},mapClick:function(e){this.form.lng=e.lnglat.lng,this.form.lat=e.lnglat.lat,this.markers[0].position=[e.lnglat.lng,e.lnglat.lat]},openMap:function(){this.loadingMap=!0,this.getLocation(!0)},selectPosition:function(){var e=this;this.map.plugin("AMap.Geocoder",(function(){var t=new AMap.Geocoder({});t.getAddress([e.form.lng,e.form.lat],(function(t,o){if("complete"===t&&"OK"===o.info){var s=o.regeocode.formattedAddress;e.formatAddress(s),e.$refs["form"].validateField("address")}}))})),this.inner=!1},formatAddress:function(e){this.form.address=e},open:function(e){e&&(this.formType=1,this.shop_id=e.shop_id,this.shopCover=e.min_logo,this.form.shop_name=e.shop_name,this.form.address=e.address,this.form.lng=e.lng,this.form.lat=e.lat),this.dialog=!0},closedDialog:function(){this.$refs["form"].clearValidate(),this.form={shop_name:"",address:"",lng:"",lat:""},this.formType=0,this.shopCover=null},submit:function(){var e=this;console.log("点击了提交"),this.$refs["form"].validate((function(t){if(t){var o={};o.shop_name=e.form.shop_name,o.address=e.form.address,1==e.formType&&(o.shop_id=e.shop_id),o.lng=e.form.lng,o.lat=e.form.lat,0==e.formType?(console.log("新增机构"),e.addShop(o)):(console.log("编辑机构"),e.modShop(o)),e.dialog=!1}}))},addShop:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(n["a"])(t).then((function(t){0==t.code&&(e.$message({message:"新增店铺成功！",type:"success"}),e.$parent.getShopList(1))}))},modShop:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(n["k"])(t).then((function(t){0==t.code&&(e.$message({message:"编辑店铺成功！",type:"success"}),e.$parent.getShopList(1))}))}}}),l=r,d=(o("0067"),o("2877")),c=Object(d["a"])(l,s,i,!1,null,"758361a8",null);t["default"]=c.exports},da09:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("media-library",{ref:"mediaLibrary",attrs:{active:"1",title:"图片库"}}),e.cover?o("div",{staticClass:"img-wrap"},[o("div",{staticClass:"img-item"},[o("i",{staticClass:"el-icon-close img-close",on:{click:e.del_cover}}),o("BaseElImage",{attrs:{custom_src:e.cover,previewList:[e.cover],fit:"cover"}})],1)]):o("div",{staticClass:"img-add",on:{click:function(t){return e.$refs.mediaLibrary.open()}}},[o("i",{staticClass:"el-icon-plus img-add-icon"})])],1)},i=[],a=o("daf4"),n={components:{mediaLibrary:a["a"]},props:{cover:{type:[Object,String],default:function(){return""}}},data:function(){return{}},mounted:function(){var e=this;this.$bus.$on("finishCoverSelectMed",(function(t){e.getData(t)}))},beforeDestroy:function(){this.$bus.$off("finishCoverSelectMed")},methods:{getData:function(e){this.$emit("update:cover",e.src_file),this.$emit("finishChoose",e.image_id),this.$refs.mediaLibrary.handleClose()},del_cover:function(){this.$emit("update:cover",""),this.$emit("finishChoose","")}}},r=n,l=(o("a7c6"),o("2877")),d=Object(l["a"])(r,s,i,!1,null,"6a2d2254",null);t["default"]=d.exports},e013:function(e,t,o){}}]);