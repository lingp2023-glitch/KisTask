(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e9b910f4"],{5613:function(t,e,o){"use strict";var r=o("e823"),n=o.n(r);n.a},cac9:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"workflow-editor"},[o("div",{staticClass:"header"},[o("h2",[t._v("工作流程图编辑器")]),o("div",{staticClass:"actions"},[o("el-button",{on:{click:t.addStartNode}},[t._v("开始节点")]),o("el-button",{on:{click:t.addProcessNode}},[t._v("流程节点")]),o("el-button",{on:{click:t.addDecisionNode}},[t._v("判断节点")]),o("el-button",{on:{click:t.addEndNode}},[t._v("结束节点")]),o("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),o("el-button",{on:{click:t.load}},[t._v("加载")]),o("el-button",{on:{click:t.exportImage}},[t._v("导出图片")])],1)]),o("div",{staticClass:"editor-container"},[o("div",{ref:"container",staticClass:"x6-graph"})])])},n=[],i=(o("96cf"),o("3b8d")),s=o("5728"),a=function(){s["b"].registerNode("start-node",{inherit:"circle",width:70,height:70,attrs:{body:{fill:"#f6ffed",stroke:"#52c41a",strokeWidth:3},label:{text:"开始",fill:"#52c41a",fontSize:16,fontWeight:"bold"}},ports:{groups:{bottom:{position:"bottom",attrs:{circle:{r:6,magnet:!0,stroke:"#52c41a",strokeWidth:2,fill:"#fff"}}}},items:[{group:"bottom"}]}}),s["b"].registerNode("process-node",{inherit:"rect",width:140,height:60,attrs:{body:{fill:"#e6f7ff",stroke:"#1890ff",strokeWidth:2,rx:8,ry:8},label:{text:"流程节点",fill:"#1890ff",fontSize:14}},ports:{groups:{top:{position:"top",attrs:{circle:{r:5,magnet:!0,stroke:"#1890ff",strokeWidth:2,fill:"#fff"}}},bottom:{position:"bottom",attrs:{circle:{r:5,magnet:!0,stroke:"#1890ff",strokeWidth:2,fill:"#fff"}}}},items:[{group:"top"},{group:"bottom"}]}}),s["b"].registerNode("decision-node",{inherit:"polygon",width:100,height:80,attrs:{body:{fill:"#fff7e6",stroke:"#fa8c16",strokeWidth:2,refPoints:"0,10 10,0 20,10 10,20"},label:{text:"判断",fill:"#fa8c16",fontSize:14}},ports:{groups:{top:{position:"top",attrs:{circle:{r:5,magnet:!0,stroke:"#fa8c16",strokeWidth:2,fill:"#fff"}}},right:{position:"right",attrs:{circle:{r:5,magnet:!0,stroke:"#fa8c16",strokeWidth:2,fill:"#fff"}}},bottom:{position:"bottom",attrs:{circle:{r:5,magnet:!0,stroke:"#fa8c16",strokeWidth:2,fill:"#fff"}}},left:{position:"left",attrs:{circle:{r:5,magnet:!0,stroke:"#fa8c16",strokeWidth:2,fill:"#fff"}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]}}),s["b"].registerNode("end-node",{inherit:"circle",width:70,height:70,attrs:{body:{fill:"#fff2f0",stroke:"#ff4d4f",strokeWidth:3},label:{text:"结束",fill:"#ff4d4f",fontSize:16,fontWeight:"bold"}},ports:{groups:{top:{position:"top",attrs:{circle:{r:6,magnet:!0,stroke:"#ff4d4f",strokeWidth:2,fill:"#fff"}}}},items:[{group:"top"}]}})},c={name:"WorkflowEditor",data:function(){return{graph:null,nodeCounter:1}},mounted:function(){this.initGraph()},beforeDestroy:function(){this.graph&&this.graph.dispose()},methods:{initGraph:function(){a(),this.graph=new s["b"]({container:this.$refs.container,width:"100%",height:700,grid:{visible:!0,type:"doubleMesh",args:[{color:"#eee",thickness:1},{color:"#ddd",thickness:1,factor:4}]},mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge:function(){return new s["c"].Edge({attrs:{line:{stroke:"#1890ff",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},labels:[{attrs:{label:{text:"条件"}}}]})}}}),this.bindEvents()},bindEvents:function(){var t=this;this.graph.on("node:click",(function(e){var o=e.node;t.$message({type:"info",message:"点击节点: ".concat(o.getAttrByPath("label/text"))})})),this.graph.on("edge:connected",(function(e){e.edge;t.$message({type:"success",message:"连接创建成功"})}))},addStartNode:function(){var t=this.graph.addNode({shape:"start-node",x:100,y:100,label:"开始",id:"node-".concat(this.nodeCounter++)});return t},addProcessNode:function(){var t=this.graph.addNode({shape:"process-node",x:100+500*Math.random(),y:200+300*Math.random(),label:"流程".concat(this.nodeCounter),id:"node-".concat(this.nodeCounter++)});return t},addDecisionNode:function(){var t=this.graph.addNode({shape:"decision-node",x:100+500*Math.random(),y:200+300*Math.random(),label:"判断".concat(this.nodeCounter),id:"node-".concat(this.nodeCounter++)});return t},addEndNode:function(){var t=this.graph.addNode({shape:"end-node",x:100+500*Math.random(),y:200+300*Math.random(),label:"结束",id:"node-".concat(this.nodeCounter++)});return t},save:function(){var t=this.graph.toJSON();localStorage.setItem("workflow-data",JSON.stringify(t)),this.$message({type:"success",message:"流程图保存成功!"})},load:function(){var t=localStorage.getItem("workflow-data");t?(this.graph.fromJSON(JSON.parse(t)),this.$message({type:"success",message:"流程图加载成功!"})):this.$message({type:"warning",message:"没有找到保存的流程图!"})},exportImage:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.graph.toPNG();case 3:e=t.sent,o=document.createElement("a"),o.download="workflow.png",o.href=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),this.$message({type:"success",message:"图片导出成功!"}),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),this.$message({type:"error",message:"图片导出失败!"});case 16:case"end":return t.stop()}}),t,this,[[0,13]])})));function e(){return t.apply(this,arguments)}return e}()}},d=c,l=(o("5613"),o("2877")),f=Object(l["a"])(d,r,n,!1,null,"5313d430",null);e["default"]=f.exports},e823:function(t,e,o){}}]);