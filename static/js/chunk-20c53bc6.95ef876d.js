(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20c53bc6","chunk-2bbd0f10","chunk-1dd3b970","chunk-1829ac85"],{"163a":function(t,e,o){"use strict";var a=o("e719"),s=o.n(a);s.a},"167a":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"addOrModStaff"},[o("el-dialog",{attrs:{title:1==t.dialogType?"编辑员工":"新增员工",visible:t.dialog,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(e){t.dialog=e},closed:t.closedDialog}},[o("el-form",{ref:"form",attrs:{"label-width":"110px",model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[o("el-input",{attrs:{type:"tel",placeholder:"请输入联系电话"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),0==t.dialogType?o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-input",{attrs:{placeholder:"请输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1):t._e(),o("el-form-item",{attrs:{label:"角色",prop:"role"}},[o("el-radio",{attrs:{label:1},model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}},[t._v("店长")]),o("el-radio",{attrs:{label:2},model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}},[t._v("店员")])],1)],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialog=!1}}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)],1)},s=[],n=(o("7f7f"),o("e692")),i=o("b4ea"),r={data:function(){return{dialogType:0,dialog:!1,staff_id:null,form:{name:"",phone:"",password:"",role:1},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}]},checkAll:!1,checkedShops:[],shops:[],isIndeterminate:!0,shopData:[]}},props:{shopId:{type:String,default:function(){return""}}},components:{},filters:{},onLoad:function(t){},onShow:function(){},mounted:function(){},computed:{},methods:{handleCheckAllChange:function(t){var e=this;console.log(t),this.checkedShops=[],t&&this.shops.map(function(t,o){e.checkedShops.push(t.shop_id)}),this.isIndeterminate=!1},handleCheckedShopsChange:function(t){console.log(t);var e=t.length;this.checkAll=e===this.shops.length,this.isIndeterminate=e>0&&e<this.shops.length},getShopList:function(){var t=this;Object(n["j"])().then(function(e){0==e.code&&(console.log(e.data),t.shops=e.data.list)})},open:function(t,e){console.log(e),"mod"==t&&(this.dialogType=1,this.staff_id=e.staff_id,this.form.name=e.name,this.form.phone=e.phone,this.form.role=e.role,console.log(this.form)),this.dialog=!0},closedDialog:function(){this.$refs["form"].clearValidate(),this.form={name:"",phone:"",password:"",role:1},this.dialogType=0,this.staff_id=null},submit:function(){var t=this;console.log("点击了提交"),this.$refs["form"].validate(function(e){if(e){console.log("验证通过");var o={};o.name=t.form.name,o.phone=t.form.phone,o.password=t.form.password,o.role=t.form.role,1==t.dialogType?(o.staff_id=t.staff_id,t.modStaff(o)):(o.shop_id=t.shopId,t.addStaff(o))}else console.log("验证失败")})},modStaff:function(t){var e=this;Object(i["f"])(t).then(function(t){0==t.code&&e.$message({message:"修改员工成功",type:"success"}),e.dialog=!1,e.$parent.refresh()})},addStaff:function(t){var e=this;Object(i["a"])(t).then(function(t){0==t.code&&e.$message({message:"新增员工成功",type:"success"}),e.dialog=!1,e.$parent.refresh()})}}},l=r,f=o("2877"),d=Object(f["a"])(l,a,s,!1,null,"1310b6a9",null);e["default"]=d.exports},"354d":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"addOrModStaff"},[o("el-dialog",{attrs:{title:t.修改密码,visible:t.dialog,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(e){t.dialog=e},closed:t.closedDialog}},[o("el-form",{ref:"form",attrs:{"label-width":"110px",model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-input",{attrs:{placeholder:"请输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialog=!1}}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)],1)},s=[],n=o("b4ea"),i={data:function(){return{dialog:!1,staff_id:null,form:{password:""},rules:{password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},props:{},components:{},filters:{},onLoad:function(t){},onShow:function(){},mounted:function(){},computed:{},methods:{open:function(t){console.log(t),this.staff_id=t.staff_id,this.dialog=!0},closedDialog:function(){this.$refs["form"].clearValidate(),this.form={password:""},this.staff_id=null},submit:function(){var t=this;console.log("点击了提交"),this.$refs["form"].validate(function(e){if(e){console.log("验证通过");var o={};o.password=t.form.password,o.staff_id=t.staff_id,t.modPassword(o)}else console.log("验证失败")})},modPassword:function(t){var e=this;Object(n["modPassword"])(t).then(function(t){0==t.code&&e.$message({message:"修改密码成功",type:"success"}),e.dialog=!1,e.$parent.refresh()})}}},r=i,l=o("2877"),f=Object(l["a"])(r,a,s,!1,null,"d1ffbce4",null);e["default"]=f.exports},b4ea:function(t,e,o){"use strict";o.d(e,"a",function(){return n}),o.d(e,"c",function(){return i}),o.d(e,"b",function(){return r}),o.d(e,"g",function(){return l}),o.d(e,"f",function(){return f}),o.d(e,"d",function(){return d});var a=o("365c"),s={addStaff:"add",getStaffList:"list",delStaff:"del",unbindStaff:"unbind",modStaff:"mod",getWxBind:"wxbind",staffActive:"active"};function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(s.addStaff,t,"api/staff")}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(s.getStaffList,t,"api/staff")}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(s.delStaff,t,"api/staff")}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(s.unbindStaff,t,"api/staff")}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(s.modStaff,t,"api/staff")}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(s.getWxBind,t,"api/staff")}},d76e:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-dialog",{attrs:{top:"10px",width:"80%",visible:t.dialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialog=e},closed:t.closedDialog}},[o("el-card",{staticClass:"anoCard"},[o("div",{staticClass:"anoCard-header",attrs:{slot:"header"},slot:"header"},[o("span",[t._v("员工管理")]),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:t.addStaff}},[t._v("\n          添加员工\n        ")])],1),o("div",{staticClass:"box"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.staffData.list,border:"","header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[o("el-table-column",{attrs:{prop:"name",label:"姓名"}}),o("el-table-column",{attrs:{prop:"phone",label:"联系电话"}}),o("el-table-column",{attrs:{prop:"role_name",label:"角色"}}),o("el-table-column",{attrs:{prop:"title",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.openid?"正常":"待激活")+"\n            ")]}}])}),o("el-table-column",{attrs:{prop:"create_time",label:"创建时间"}}),o("el-table-column",{attrs:{prop:"status",label:"操作",width:"200px",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-link",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary"},on:{click:function(o){return t.modStaff(e.row)}}},[t._v("编辑")]),o("el-link",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary"},on:{click:function(o){return t.modPassword(e.row)}}},[t._v("修改密码")]),o("el-popconfirm",{attrs:{title:"你确定要删除吗？",confirmButtonType:"danger"},on:{confirm:function(o){return t.delStaff(e.row.staff_id)}}},[o("el-link",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1)]}}])})],1)],1)])],1),o("add-or-mod-staff",{ref:"addOrModStaff",attrs:{shopId:t.shop_id}}),o("wx-bind-dia",{ref:"wxBindDia"}),o("mod-password",{ref:"modPassword"})],1)},s=[],n=o("b4ea"),i=o("167a"),r=o("e4b4"),l=o("354d"),f={data:function(){return{shop_id:"",staffData:{},dialog:!1}},components:{addOrModStaff:i["default"],wxBindDia:r["default"],modPassword:l["default"]},filters:{},created:function(){},onShow:function(){},mounted:function(){},computed:{},methods:{open:function(t){this.shop_id=t,this.getStaffList(),this.dialog=!0},closedDialog:function(){},wxBind:function(t){this.$refs["wxBindDia"].open(t)},shopsList:function(t){return t.shops_name?t.shops_name:[]},modPassword:function(t){this.$refs["modPassword"].open(t)},modStaff:function(t){this.$refs["addOrModStaff"].open("mod",t)},unbindStaff:function(t){var e=this;Object(n["g"])({staff_id:t}).then(function(t){0==t.code&&(e.$message({message:"员工解绑成功",type:"success"}),e.refresh())})},delStaff:function(t){var e=this;Object(n["b"])({staff_id:t}).then(function(t){0==t.code&&(e.$message({message:"员工删除成功",type:"success"}),e.refresh())})},refresh:function(t){this.getStaffList(t||this.staffData.page)},getStaffList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Object(n["c"])({shop_id:this.shop_id,page:e}).then(function(e){0==e.code&&(t.staffData=e.data)},function(t){console.log(t)})},addStaff:function(){this.$refs["addOrModStaff"].open("add")}}},d=f,c=o("2877"),u=Object(c["a"])(d,a,s,!1,null,"d345c998",null);e["default"]=u.exports},e4b4:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"wxBindDia"},[o("el-dialog",{attrs:{title:"员工激活",visible:t.dialog,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(e){t.dialog=e},closed:t.closedDialog}},[o("div",{staticClass:"qrCode"},[o("el-image",{staticStyle:{width:"300px",height:"300px"},attrs:{src:t.qrCode}}),o("div",{staticStyle:{"margin-top":"10px"}},[t._v("请用微信扫码激活")])],1)])],1)},s=[],n=o("b4ea"),i={data:function(){return{dialog:!1,staff_id:null,qrCode:null}},components:{},filters:{},onLoad:function(t){},onShow:function(){},mounted:function(){},computed:{},methods:{closedDialog:function(){this.staff_id=null,this.qrCode=""},open:function(t){this.staff_id=t,this.getWxBind(),this.dialog=!0},getWxBind:function(){var t=this;Object(n["d"])({staff_id:this.staff_id}).then(function(e){0==e.code?t.qrCode=e.data.qrurl:t.$message({message:e.msg?e.msg:"二维码获取失败",type:"error"})})}}},r=i,l=(o("163a"),o("2877")),f=Object(l["a"])(r,a,s,!1,null,"122e53d6",null);e["default"]=f.exports},e719:function(t,e,o){}}]);