(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60011e38","chunk-6313dd7d"],{5132:function(e,t,s){"use strict";s.d(t,"e",(function(){return r})),s.d(t,"b",(function(){return n})),s.d(t,"d",(function(){return l})),s.d(t,"a",(function(){return o})),s.d(t,"c",(function(){return u}));var a=s("365c"),i={addIssue:"add",issueList:"list",queryWorker:"queryWorker",issueInfo:"info",submitIssue:"submit"};function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(i.submitIssue,e,"api/issue")}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(i.issueInfo,e,"api/issue")}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(i.queryWorker,e,"api/issue")}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(i.addIssue,e,"api/issue")}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["a"].post(i.issueList,e,"api/issue")}},"566c":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"className"},[s("el-card",{staticClass:"anoCard"},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[e._v("我的工作")])]),s("div",{staticClass:"searchDiv"},[s("div",{staticClass:"search-name"},[s("el-input",{attrs:{placeholder:"查询字符"},model:{value:e.searchData.query_str,callback:function(t){e.$set(e.searchData,"query_str",t)},expression:"searchData.query_str"}})],1),s("div",{staticClass:"search-btn"},[s("el-button",{attrs:{type:"success"},on:{click:e.getIssueList}},[e._v("搜索")])],1)]),s("div",[s("el-tabs",{on:{"tab-click":e.handleTabsClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"待办",name:"work"}}),s("el-tab-pane",{attrs:{label:"已办",name:"finish"}}),s("el-tab-pane",{attrs:{label:"已创建",name:"create"}})],1)],1),s("div",{staticClass:"box"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.issuesData.list,border:"","header-cell-style":{background:"#f5f7fa",color:"#606266"}},on:{"cell-click":e.showIssuesDetail}},[s("el-table-column",{attrs:{prop:"title",label:"标题"}}),s("el-table-column",{attrs:{prop:"priority_name",width:"100",label:"优先级"}}),s("el-table-column",{attrs:{prop:"severity_name",width:"100",label:"严重程度"}}),s("el-table-column",{attrs:{prop:"status",width:"100",label:"状态"}}),s("el-table-column",{attrs:{prop:"workers",width:"150",label:"处理人"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",e._l(t.row.workers,(function(a,i){return s("span",{key:i},[e._v(e._s(i==t.row.workers.length-1?a.name:a.name+"、"))])})),0)]}}])}),s("el-table-column",{attrs:{prop:"creater_name",width:"150",label:"创建人"}}),s("el-table-column",{attrs:{prop:"create_time",width:"200",label:"创建时间"}})],1)],1),s("pagination",{attrs:{data:e.issuesData},on:{change:e.getIssueList}})],1),s("el-drawer",{attrs:{visible:e.showDetail,direction:"rtl",size:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.showDetail=t}}},[s("div",{staticClass:"issuesBox"},[s("div",{staticClass:"boxLeft"},[s("div",{staticClass:"leftHeader"},[s("div",{staticClass:"statusBox activeStatus"},[e._v(e._s(e.issuesDetail.status))]),s("div",{staticClass:"boxTitle"},[e._v("\n            "+e._s(e.issuesDetail.title)+"\n          ")])]),s("div",{staticClass:"boxContent",domProps:{innerHTML:e._s(e.issuesDetail.content)}}),s("div",{staticClass:"subTitle"},[e._v("\n          工作流\n        ")]),s("div",{staticClass:"statusGroup"},e._l(e.issuesDetail.dst_status,(function(t,a){return s("div",{key:a,staticClass:"statusBox",class:{activeStatus:e.issuesType==t},on:{click:function(s){return e.changeStatus(t)}}},[e._v(e._s(t))])})),0),s("div",{staticClass:"flowContent"},[s("el-form",{ref:"form",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"auto"}},[s("el-form-item",{attrs:{label:"处理人",prop:"workers"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"搜索选择处理人","remote-method":e.queryWorker,loading:e.loadingWorker},on:{change:e.changWorker},model:{value:e.form.workers,callback:function(t){e.$set(e.form,"workers",t)},expression:"form.workers"}},e._l(e.workersList,(function(e){return s("el-option",{key:e.userid,attrs:{label:e.name,value:e.userid}})})),1)],1)],1),s("u-e",{ref:"quill",staticClass:"introClass",on:{senHtml:e.getHtml}})],1),s("div",{staticClass:"controlBtn"},[s("el-button",{attrs:{type:"primary"},on:{click:e.submitIssue}},[e._v("提 交")])],1)]),s("div",{staticClass:"boxRight"},[s("el-descriptions",{attrs:{title:"基础信息",column:1}},[s("el-descriptions-item",{attrs:{label:"优先级"}},[e._v(e._s(e.issuesDetail.priority_name))]),s("el-descriptions-item",{attrs:{label:"严重程度"}},[e._v(e._s(e.issuesDetail.severity_name))]),s("el-descriptions-item",{attrs:{label:"状态"}},[e._v(e._s(e.issuesDetail.status))]),s("el-descriptions-item",{attrs:{label:"处理人"}},e._l(e.issuesDetail.workers,(function(t,a){return s("span",{key:a},[e._v(e._s(a==e.issuesDetail.workers.length-1?t.name:t.name+"、"))])})),0),s("el-descriptions-item",{attrs:{label:"创建人"}},[e._v(e._s(e.issuesDetail.creater_name))]),s("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.issuesDetail.create_time))])],1)],1)])])],1)},i=[],r=s("bd86"),n=(s("7f7f"),s("5132")),l=s("4632"),o=s("cf2d"),u={name:"user",components:{pagination:l["a"],UE:o["a"]},data:function(){return{activeName:"work",searchData:{query_str:""},issuesData:{},showDetail:!1,issuesDetail:{},issuesType:"",form:{workers:[],content:""},rules:{workers:[{required:!0,message:"搜索选择处理人",trigger:"blur"}]},loadingWorker:!1,workersList:[]}},filters:{},computed:{page:function(){return this.issuesData.page}},created:function(){this.getIssueList()},methods:Object(r["a"])({submitIssue:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var s={};s.issue_id=e.issuesDetail.issue_id,s.workers=JSON.stringify(e.form.workers),s.status=e.issuesType,s.content=e.form.content,Object(n["e"])(s).then((function(t){0==t.code&&(e.$message({message:"提交成功",type:"success"}),e.handleClose())}))}}))},changWorker:function(){this.$refs["form"].validateField("workers")},queryWorker:function(e){var t=this;this.loading=!0,Object(n["d"])({query_str:e,project_id:this.issuesDetail.project_id}).then((function(e){0==e.code&&(t.workersList=e.data)}))},getHtml:function(e){this.form.content=e},changeStatus:function(e){this.issuesType=e},showIssuesDetail:function(e){var t=this;console.log(e),Object(n["b"])({issue_id:e.issue_id}).then((function(e){t.issuesDetail=e.data,t.issuesType=t.issuesDetail.dst_status[0],t.showDetail=!0,t.queryWorker()}))},handleClose:function(){this.$refs["form"].clearValidate(),this.form={workers:[],content:""},this.$refs.quill.setContent(""),this.showDetail=!1},handleTabsClick:function(e){console.log(e.name),this.activeName=e.name,this.getIssueList()},getIssueList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=this.searchData.query_str;Object(n["c"])({page:t,query_str:s,query_code:this.activeName}).then((function(t){0==t.code&&(e.issuesData=t.data)}))}},"changWorker",(function(){this.$refs["form"].validateField("workers")}))},c=u,d=(s("ccac"),s("2877")),f=Object(d["a"])(c,a,i,!1,null,null,null);t["default"]=f.exports},"58c6":function(e,t,s){},b9c2:function(e,t,s){"use strict";s.r(t);var a=s("566c");t["default"]=a["default"]},ccac:function(e,t,s){"use strict";var a=s("58c6"),i=s.n(a);i.a}}]);